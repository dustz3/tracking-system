doctype html
html(lang="zh-TW")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title API èª¿è©¦é é¢
    style.
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      .test-section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }
      .success { background: #d4edda; border-color: #c3e6cb; }
      .error { background: #f8d7da; border-color: #f5c6cb; }
      .loading { background: #fff3cd; border-color: #ffeaa7; }
      button {
        padding: 10px 20px;
        margin: 5px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        background: #007bff;
        color: white;
      }
      button:hover { background: #0056b3; }
      pre {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 5px;
        overflow-x: auto;
      }
  
  body
    .container
      h1 ğŸ” API èª¿è©¦é é¢
      
      .test-section
        h3 æœ¬åœ° API æ¸¬è©¦
        button(onclick="testLocalAPI()") æ¸¬è©¦æœ¬åœ° API
        #localResult
      
      .test-section
        h3 é ç¨‹ API æ¸¬è©¦
        button(onclick="testRemoteAPI()") æ¸¬è©¦é ç¨‹ API
        #remoteResult
      
      .test-section
        h3 è¿½è¹¤æŸ¥è©¢æ¸¬è©¦
        input#trackingInput(type="text" placeholder="è¼¸å…¥è¿½è¹¤è™Ÿç¢¼" value="TM-24070101")
        button(onclick="testTrackingQuery()") æ¸¬è©¦æŸ¥è©¢
        #trackingResult
    
    script.
      async function testLocalAPI() {
        const resultDiv = document.getElementById('localResult');
        resultDiv.innerHTML = '<div class="loading">æ¸¬è©¦ä¸­...</div>';
        
        try {
          const response = await fetch('http://localhost:3001/api/test-connection');
          const data = await response.json();
          
          if (response.ok) {
            resultDiv.innerHTML = `<div class="success">
              <h4>âœ… æœ¬åœ° API æ­£å¸¸</h4>
              <pre>${JSON.stringify(data, null, 2)}</pre>
            </div>`;
          } else {
            resultDiv.innerHTML = `<div class="error">
              <h4>âŒ æœ¬åœ° API éŒ¯èª¤</h4>
              <pre>ç‹€æ…‹: ${response.status}\n${JSON.stringify(data, null, 2)}</pre>
            </div>`;
          }
        } catch (error) {
          resultDiv.innerHTML = `<div class="error">
            <h4>âŒ æœ¬åœ° API é€£æ¥å¤±æ•—</h4>
            <pre>${error.message}</pre>
          </div>`;
        }
      }
      
      async function testRemoteAPI() {
        const resultDiv = document.getElementById('remoteResult');
        resultDiv.innerHTML = '<div class="loading">æ¸¬è©¦ä¸­...</div>';
        
        try {
          const response = await fetch('https://tracking-system-f6d5.onrender.com/api/test-connection');
          const data = await response.json();
          
          if (response.ok) {
            resultDiv.innerHTML = `<div class="success">
              <h4>âœ… é ç¨‹ API æ­£å¸¸</h4>
              <pre>${JSON.stringify(data, null, 2)}</pre>
            </div>`;
          } else {
            resultDiv.innerHTML = `<div class="error">
              <h4>âŒ é ç¨‹ API éŒ¯èª¤</h4>
              <pre>ç‹€æ…‹: ${response.status}\n${JSON.stringify(data, null, 2)}</pre>
            </div>`;
          }
        } catch (error) {
          resultDiv.innerHTML = `<div class="error">
            <h4>âŒ é ç¨‹ API é€£æ¥å¤±æ•—</h4>
            <pre>${error.message}</pre>
          </div>`;
        }
      }
      
      async function testTrackingQuery() {
        const resultDiv = document.getElementById('trackingResult');
        const trackingId = document.getElementById('trackingInput').value;
        
        if (!trackingId) {
          resultDiv.innerHTML = '<div class="error">è«‹è¼¸å…¥è¿½è¹¤è™Ÿç¢¼</div>';
          return;
        }
        
        resultDiv.innerHTML = '<div class="loading">æŸ¥è©¢ä¸­...</div>';
        
        try {
          const response = await fetch(`http://localhost:3001/api/search-tracking?trackingId=${encodeURIComponent(trackingId)}`);
          const data = await response.json();
          
          if (response.ok) {
            resultDiv.innerHTML = `<div class="success">
              <h4>âœ… æŸ¥è©¢æˆåŠŸ</h4>
              <pre>${JSON.stringify(data, null, 2)}</pre>
            </div>`;
          } else {
            resultDiv.innerHTML = `<div class="error">
              <h4>âŒ æŸ¥è©¢å¤±æ•—</h4>
              <pre>ç‹€æ…‹: ${response.status}\n${JSON.stringify(data, null, 2)}</pre>
            </div>`;
          }
        } catch (error) {
          resultDiv.innerHTML = `<div class="error">
            <h4>âŒ æŸ¥è©¢é€£æ¥å¤±æ•—</h4>
            <pre>${error.message}</pre>
          </div>`;
        }
      } 